##for HSPICE netlist
import re
import function
import os
import sys
import math

import numpy as np
from scipy import interpolate


def gen_dcdc_netlist(cells, args, jsonSpec, platformConfig, srcDir):

    # power mux models
    xs = list(range(100, 10001, 100))
    ys = [
        0,
        0.1,
        0.2,
        0.3,
        0.4,
        0.5,
        0.6,
        0.7,
        0.8,
        0.9,
        1,
        1.1,
        1.2,
        1.3,
        1.4,
        1.5,
        1.6,
        1.7,
        1.8,
    ]
    zz = np.array(
        [
            2.724e-12,
            4.749e-04,
            8.991e-04,
            1.267e-03,
            1.570e-03,
            1.788e-03,
            1.911e-03,
            1.980e-03,
            2.029e-03,
            2.075e-03,
            2.136e-03,
            2.216e-03,
            2.313e-03,
            2.426e-03,
            2.553e-03,
            2.690e-03,
            2.836e-03,
            2.990e-03,
            3.149e-03,
            1.818e-12,
            3.223e-04,
            6.211e-04,
            8.915e-04,
            1.128e-03,
            1.322e-03,
            1.458e-03,
            1.534e-03,
            1.580e-03,
            1.617e-03,
            1.663e-03,
            1.724e-03,
            1.798e-03,
            1.884e-03,
            1.980e-03,
            2.084e-03,
            2.196e-03,
            2.313e-03,
            2.435e-03,
            1.364e-12,
            2.439e-04,
            4.742e-04,
            6.874e-04,
            8.790e-04,
            1.043e-03,
            1.172e-03,
            1.253e-03,
            1.297e-03,
            1.330e-03,
            1.367e-03,
            1.416e-03,
            1.476e-03,
            1.545e-03,
            1.623e-03,
            1.708e-03,
            1.799e-03,
            1.895e-03,
            1.995e-03,
            1.091e-12,
            1.961e-04,
            3.834e-04,
            5.593e-04,
            7.202e-04,
            8.615e-04,
            9.772e-04,
            1.058e-03,
            1.102e-03,
            1.132e-03,
            1.163e-03,
            1.204e-03,
            1.255e-03,
            1.313e-03,
            1.380e-03,
            1.452e-03,
            1.530e-03,
            1.612e-03,
            1.698e-03,
            9.098e-13,
            1.640e-04,
            3.218e-04,
            4.714e-04,
            6.100e-04,
            7.339e-04,
            8.379e-04,
            9.148e-04,
            9.593e-04,
            9.863e-04,
            1.014e-03,
            1.049e-03,
            1.093e-03,
            1.144e-03,
            1.202e-03,
            1.266e-03,
            1.334e-03,
            1.407e-03,
            1.484e-03,
            7.799e-13,
            1.409e-04,
            2.772e-04,
            4.074e-04,
            5.291e-04,
            6.393e-04,
            7.335e-04,
            8.057e-04,
            8.497e-04,
            8.751e-04,
            8.996e-04,
            9.309e-04,
            9.697e-04,
            1.015e-03,
            1.067e-03,
            1.124e-03,
            1.186e-03,
            1.252e-03,
            1.324e-03,
            6.825e-13,
            1.235e-04,
            2.435e-04,
            3.587e-04,
            4.672e-04,
            5.664e-04,
            6.524e-04,
            7.200e-04,
            7.629e-04,
            7.870e-04,
            8.092e-04,
            8.373e-04,
            8.722e-04,
            9.134e-04,
            9.602e-04,
            1.012e-03,
            1.070e-03,
            1.132e-03,
            1.202e-03,
            6.067e-13,
            1.099e-04,
            2.171e-04,
            3.204e-04,
            4.183e-04,
            5.085e-04,
            5.875e-04,
            6.508e-04,
            6.925e-04,
            7.156e-04,
            7.359e-04,
            7.614e-04,
            7.932e-04,
            8.309e-04,
            8.741e-04,
            9.224e-04,
            9.764e-04,
            1.037e-03,
            1.108e-03,
            5.461e-13,
            9.903e-05,
            1.958e-04,
            2.895e-04,
            3.786e-04,
            4.613e-04,
            5.345e-04,
            5.939e-04,
            6.341e-04,
            6.563e-04,
            6.751e-04,
            6.985e-04,
            7.278e-04,
            7.627e-04,
            8.029e-04,
            8.485e-04,
            9.003e-04,
            9.607e-04,
            1.036e-03,
            4.965e-13,
            9.011e-05,
            1.784e-04,
            2.640e-04,
            3.459e-04,
            4.222e-04,
            4.903e-04,
            5.462e-04,
            5.850e-04,
            6.064e-04,
            6.239e-04,
            6.456e-04,
            6.728e-04,
            7.054e-04,
            7.432e-04,
            7.867e-04,
            8.372e-04,
            8.990e-04,
            9.813e-04,
            4.551e-13,
            8.266e-05,
            1.638e-04,
            2.426e-04,
            3.183e-04,
            3.892e-04,
            4.529e-04,
            5.057e-04,
            5.430e-04,
            5.637e-04,
            5.802e-04,
            6.004e-04,
            6.258e-04,
            6.565e-04,
            6.924e-04,
            7.343e-04,
            7.845e-04,
            8.493e-04,
            9.400e-04,
            4.201e-13,
            7.635e-05,
            1.514e-04,
            2.245e-04,
            2.948e-04,
            3.610e-04,
            4.208e-04,
            4.709e-04,
            5.067e-04,
            5.268e-04,
            5.423e-04,
            5.613e-04,
            5.852e-04,
            6.143e-04,
            6.486e-04,
            6.894e-04,
            7.401e-04,
            8.103e-04,
            9.065e-04,
            3.901e-13,
            7.094e-05,
            1.407e-04,
            2.089e-04,
            2.746e-04,
            3.366e-04,
            3.930e-04,
            4.406e-04,
            4.751e-04,
            4.946e-04,
            5.093e-04,
            5.271e-04,
            5.498e-04,
            5.775e-04,
            6.105e-04,
            6.507e-04,
            7.026e-04,
            7.785e-04,
            8.751e-04,
            3.641e-13,
            6.624e-05,
            1.315e-04,
            1.953e-04,
            2.569e-04,
            3.154e-04,
            3.687e-04,
            4.140e-04,
            4.472e-04,
            4.662e-04,
            4.801e-04,
            4.970e-04,
            5.186e-04,
            5.451e-04,
            5.771e-04,
            6.169e-04,
            6.716e-04,
            7.509e-04,
            8.442e-04,
            3.414e-13,
            6.212e-05,
            1.234e-04,
            1.833e-04,
            2.414e-04,
            2.966e-04,
            3.472e-04,
            3.905e-04,
            4.225e-04,
            4.409e-04,
            4.542e-04,
            4.703e-04,
            4.909e-04,
            5.164e-04,
            5.476e-04,
            5.874e-04,
            6.450e-04,
            7.273e-04,
            8.140e-04,
            3.213e-13,
            5.849e-05,
            1.162e-04,
            1.728e-04,
            2.277e-04,
            2.800e-04,
            3.281e-04,
            3.695e-04,
            4.004e-04,
            4.183e-04,
            4.311e-04,
            4.464e-04,
            4.661e-04,
            4.907e-04,
            5.213e-04,
            5.615e-04,
            6.224e-04,
            7.047e-04,
            7.850e-04,
            3.035e-13,
            5.526e-05,
            1.098e-04,
            1.634e-04,
            2.154e-04,
            2.651e-04,
            3.110e-04,
            3.507e-04,
            3.805e-04,
            3.980e-04,
            4.102e-04,
            4.249e-04,
            4.439e-04,
            4.677e-04,
            4.978e-04,
            5.392e-04,
            6.027e-04,
            6.825e-04,
            7.572e-04,
            2.875e-13,
            5.236e-05,
            1.041e-04,
            1.549e-04,
            2.044e-04,
            2.517e-04,
            2.956e-04,
            3.337e-04,
            3.626e-04,
            3.796e-04,
            3.914e-04,
            4.055e-04,
            4.237e-04,
            4.469e-04,
            4.767e-04,
            5.192e-04,
            5.850e-04,
            6.608e-04,
            7.307e-04,
            2.731e-13,
            4.976e-05,
            9.895e-05,
            1.473e-04,
            1.945e-04,
            2.396e-04,
            2.816e-04,
            3.183e-04,
            3.463e-04,
            3.628e-04,
            3.742e-04,
            3.878e-04,
            4.054e-04,
            4.280e-04,
            4.576e-04,
            5.015e-04,
            5.682e-04,
            6.400e-04,
            7.056e-04,
            2.601e-13,
            4.740e-05,
            9.429e-05,
            1.404e-04,
            1.854e-04,
            2.287e-04,
            2.690e-04,
            3.043e-04,
            3.314e-04,
            3.476e-04,
            3.586e-04,
            3.716e-04,
            3.887e-04,
            4.108e-04,
            4.403e-04,
            4.858e-04,
            5.529e-04,
            6.201e-04,
            6.817e-04,
            2.483e-13,
            4.526e-05,
            9.004e-05,
            1.341e-04,
            1.772e-04,
            2.187e-04,
            2.574e-04,
            2.915e-04,
            3.178e-04,
            3.335e-04,
            3.442e-04,
            3.568e-04,
            3.734e-04,
            3.950e-04,
            4.245e-04,
            4.717e-04,
            5.379e-04,
            6.010e-04,
            6.591e-04,
            2.375e-13,
            4.330e-05,
            8.616e-05,
            1.284e-04,
            1.697e-04,
            2.095e-04,
            2.468e-04,
            2.797e-04,
            3.052e-04,
            3.206e-04,
            3.310e-04,
            3.432e-04,
            3.593e-04,
            3.806e-04,
            4.106e-04,
            4.589e-04,
            5.233e-04,
            5.828e-04,
            6.377e-04,
            2.276e-13,
            4.150e-05,
            8.260e-05,
            1.231e-04,
            1.628e-04,
            2.010e-04,
            2.370e-04,
            2.688e-04,
            2.937e-04,
            3.087e-04,
            3.187e-04,
            3.306e-04,
            3.463e-04,
            3.672e-04,
            3.976e-04,
            4.472e-04,
            5.091e-04,
            5.655e-04,
            6.175e-04,
            2.185e-13,
            3.985e-05,
            7.933e-05,
            1.183e-04,
            1.564e-04,
            1.933e-04,
            2.279e-04,
            2.588e-04,
            2.830e-04,
            2.980e-04,
            3.074e-04,
            3.189e-04,
            3.343e-04,
            3.549e-04,
            3.857e-04,
            4.362e-04,
            4.954e-04,
            5.489e-04,
            5.984e-04,
            2.101e-13,
            3.832e-05,
            7.630e-05,
            1.138e-04,
            1.505e-04,
            1.861e-04,
            2.196e-04,
            2.495e-04,
            2.730e-04,
            2.877e-04,
            2.969e-04,
            3.081e-04,
            3.231e-04,
            3.435e-04,
            3.747e-04,
            4.258e-04,
            4.822e-04,
            5.332e-04,
            5.803e-04,
            2.023e-13,
            3.691e-05,
            7.350e-05,
            1.096e-04,
            1.451e-04,
            1.794e-04,
            2.118e-04,
            2.408e-04,
            2.637e-04,
            2.782e-04,
            2.871e-04,
            2.980e-04,
            3.127e-04,
            3.329e-04,
            3.647e-04,
            4.156e-04,
            4.696e-04,
            5.182e-04,
            5.632e-04,
            1.951e-13,
            3.559e-05,
            7.089e-05,
            1.058e-04,
            1.400e-04,
            1.732e-04,
            2.046e-04,
            2.327e-04,
            2.551e-04,
            2.692e-04,
            2.779e-04,
            2.885e-04,
            3.029e-04,
            3.230e-04,
            3.554e-04,
            4.064e-04,
            4.576e-04,
            5.039e-04,
            5.470e-04,
            1.884e-13,
            3.437e-05,
            6.847e-05,
            1.022e-04,
            1.353e-04,
            1.674e-04,
            1.978e-04,
            2.252e-04,
            2.470e-04,
            2.609e-04,
            2.693e-04,
            2.797e-04,
            2.938e-04,
            3.138e-04,
            3.468e-04,
            3.973e-04,
            4.460e-04,
            4.903e-04,
            5.316e-04,
            1.821e-13,
            3.323e-05,
            6.620e-05,
            9.880e-05,
            1.308e-04,
            1.619e-04,
            1.915e-04,
            2.181e-04,
            2.394e-04,
            2.530e-04,
            2.613e-04,
            2.714e-04,
            2.853e-04,
            3.055e-04,
            3.388e-04,
            3.881e-04,
            4.349e-04,
            4.773e-04,
            5.170e-04,
            1.762e-13,
            3.216e-05,
            6.408e-05,
            9.565e-05,
            1.267e-04,
            1.569e-04,
            1.855e-04,
            2.115e-04,
            2.323e-04,
            2.457e-04,
            2.537e-04,
            2.636e-04,
            2.773e-04,
            2.974e-04,
            3.313e-04,
            3.795e-04,
            4.243e-04,
            4.650e-04,
            5.031e-04,
            1.707e-13,
            3.116e-05,
            6.209e-05,
            9.270e-05,
            1.228e-04,
            1.521e-04,
            1.800e-04,
            2.052e-04,
            2.256e-04,
            2.387e-04,
            2.466e-04,
            2.563e-04,
            2.697e-04,
            2.899e-04,
            3.242e-04,
            3.712e-04,
            4.141e-04,
            4.532e-04,
            4.899e-04,
            1.656e-13,
            3.021e-05,
            6.022e-05,
            8.992e-05,
            1.191e-04,
            1.476e-04,
            1.747e-04,
            1.993e-04,
            2.193e-04,
            2.322e-04,
            2.398e-04,
            2.494e-04,
            2.626e-04,
            2.827e-04,
            3.176e-04,
            3.635e-04,
            4.044e-04,
            4.420e-04,
            4.774e-04,
            1.607e-13,
            2.933e-05,
            5.846e-05,
            8.730e-05,
            1.157e-04,
            1.434e-04,
            1.697e-04,
            1.938e-04,
            2.133e-04,
            2.260e-04,
            2.335e-04,
            2.428e-04,
            2.559e-04,
            2.761e-04,
            3.113e-04,
            3.556e-04,
            3.950e-04,
            4.312e-04,
            4.655e-04,
            1.561e-13,
            2.849e-05,
            5.680e-05,
            8.483e-05,
            1.124e-04,
            1.394e-04,
            1.651e-04,
            1.885e-04,
            2.076e-04,
            2.201e-04,
            2.274e-04,
            2.366e-04,
            2.495e-04,
            2.698e-04,
            3.052e-04,
            3.481e-04,
            3.861e-04,
            4.210e-04,
            4.541e-04,
            1.518e-13,
            2.770e-05,
            5.523e-05,
            8.250e-05,
            1.094e-04,
            1.356e-04,
            1.606e-04,
            1.835e-04,
            2.023e-04,
            2.145e-04,
            2.217e-04,
            2.308e-04,
            2.435e-04,
            2.638e-04,
            2.994e-04,
            3.408e-04,
            3.774e-04,
            4.112e-04,
            4.432e-04,
            1.477e-13,
            2.696e-05,
            5.375e-05,
            8.029e-05,
            1.065e-04,
            1.320e-04,
            1.564e-04,
            1.788e-04,
            1.972e-04,
            2.092e-04,
            2.163e-04,
            2.252e-04,
            2.378e-04,
            2.582e-04,
            2.938e-04,
            3.338e-04,
            3.692e-04,
            4.018e-04,
            4.328e-04,
            1.438e-13,
            2.625e-05,
            5.234e-05,
            7.820e-05,
            1.037e-04,
            1.286e-04,
            1.525e-04,
            1.743e-04,
            1.923e-04,
            2.042e-04,
            2.112e-04,
            2.199e-04,
            2.323e-04,
            2.528e-04,
            2.885e-04,
            3.270e-04,
            3.612e-04,
            3.928e-04,
            4.229e-04,
            1.401e-13,
            2.558e-05,
            5.101e-05,
            7.621e-05,
            1.011e-04,
            1.254e-04,
            1.487e-04,
            1.701e-04,
            1.877e-04,
            1.994e-04,
            2.065e-04,
            2.149e-04,
            2.271e-04,
            2.478e-04,
            2.830e-04,
            3.205e-04,
            3.536e-04,
            3.842e-04,
            4.134e-04,
            1.366e-13,
            2.494e-05,
            4.974e-05,
            7.432e-05,
            9.858e-05,
            1.223e-04,
            1.451e-04,
            1.660e-04,
            1.834e-04,
            1.949e-04,
            2.018e-04,
            2.100e-04,
            2.222e-04,
            2.430e-04,
            2.782e-04,
            3.142e-04,
            3.463e-04,
            3.760e-04,
            4.044e-04,
            1.333e-13,
            2.433e-05,
            4.853e-05,
            7.253e-05,
            9.621e-05,
            1.194e-04,
            1.416e-04,
            1.622e-04,
            1.792e-04,
            1.905e-04,
            1.973e-04,
            2.055e-04,
            2.175e-04,
            2.384e-04,
            2.734e-04,
            3.081e-04,
            3.392e-04,
            3.681e-04,
            3.957e-04,
            1.301e-13,
            2.376e-05,
            4.738e-05,
            7.081e-05,
            9.395e-05,
            1.166e-04,
            1.384e-04,
            1.585e-04,
            1.752e-04,
            1.864e-04,
            1.931e-04,
            2.011e-04,
            2.133e-04,
            2.341e-04,
            2.688e-04,
            3.023e-04,
            3.324e-04,
            3.605e-04,
            3.873e-04,
            1.271e-13,
            2.320e-05,
            4.628e-05,
            6.918e-05,
            9.180e-05,
            1.139e-04,
            1.353e-04,
            1.550e-04,
            1.714e-04,
            1.824e-04,
            1.890e-04,
            1.969e-04,
            2.090e-04,
            2.299e-04,
            2.640e-04,
            2.966e-04,
            3.259e-04,
            3.532e-04,
            3.793e-04,
            1.242e-13,
            2.268e-05,
            4.524e-05,
            6.762e-05,
            8.974e-05,
            1.114e-04,
            1.323e-04,
            1.516e-04,
            1.677e-04,
            1.786e-04,
            1.851e-04,
            1.929e-04,
            2.049e-04,
            2.260e-04,
            2.595e-04,
            2.912e-04,
            3.196e-04,
            3.461e-04,
            3.716e-04,
            1.214e-13,
            2.217e-05,
            4.424e-05,
            6.613e-05,
            8.777e-05,
            1.090e-04,
            1.294e-04,
            1.484e-04,
            1.642e-04,
            1.749e-04,
            1.813e-04,
            1.890e-04,
            2.010e-04,
            2.222e-04,
            2.552e-04,
            2.859e-04,
            3.135e-04,
            3.394e-04,
            3.642e-04,
            1.188e-13,
            2.169e-05,
            4.328e-05,
            6.471e-05,
            8.588e-05,
            1.066e-04,
            1.267e-04,
            1.453e-04,
            1.609e-04,
            1.714e-04,
            1.777e-04,
            1.853e-04,
            1.972e-04,
            2.186e-04,
            2.509e-04,
            2.808e-04,
            3.077e-04,
            3.329e-04,
            3.571e-04,
            1.162e-13,
            2.123e-05,
            4.236e-05,
            6.334e-05,
            8.408e-05,
            1.044e-04,
            1.241e-04,
            1.423e-04,
            1.577e-04,
            1.681e-04,
            1.743e-04,
            1.818e-04,
            1.936e-04,
            2.151e-04,
            2.469e-04,
            2.759e-04,
            3.020e-04,
            3.266e-04,
            3.503e-04,
            1.138e-13,
            2.079e-05,
            4.148e-05,
            6.203e-05,
            8.235e-05,
            1.023e-04,
            1.215e-04,
            1.395e-04,
            1.546e-04,
            1.648e-04,
            1.710e-04,
            1.784e-04,
            1.901e-04,
            2.117e-04,
            2.429e-04,
            2.711e-04,
            2.966e-04,
            3.206e-04,
            3.437e-04,
            1.115e-13,
            2.037e-05,
            4.064e-05,
            6.077e-05,
            8.069e-05,
            1.002e-04,
            1.191e-04,
            1.367e-04,
            1.516e-04,
            1.617e-04,
            1.678e-04,
            1.751e-04,
            1.868e-04,
            2.085e-04,
            2.390e-04,
            2.665e-04,
            2.913e-04,
            3.148e-04,
            3.373e-04,
            1.093e-13,
            1.996e-05,
            3.983e-05,
            5.957e-05,
            7.909e-05,
            9.826e-05,
            1.168e-04,
            1.341e-04,
            1.487e-04,
            1.588e-04,
            1.647e-04,
            1.720e-04,
            1.836e-04,
            2.054e-04,
            2.352e-04,
            2.620e-04,
            2.862e-04,
            3.091e-04,
            3.312e-04,
            1.071e-13,
            1.957e-05,
            3.905e-05,
            5.841e-05,
            7.756e-05,
            9.637e-05,
            1.146e-04,
            1.316e-04,
            1.460e-04,
            1.559e-04,
            1.618e-04,
            1.689e-04,
            1.806e-04,
            2.023e-04,
            2.316e-04,
            2.576e-04,
            2.813e-04,
            3.037e-04,
            3.253e-04,
            1.051e-13,
            1.920e-05,
            3.831e-05,
            5.729e-05,
            7.608e-05,
            9.455e-05,
            1.124e-04,
            1.291e-04,
            1.433e-04,
            1.531e-04,
            1.589e-04,
            1.660e-04,
            1.776e-04,
            1.994e-04,
            2.280e-04,
            2.534e-04,
            2.766e-04,
            2.985e-04,
            3.196e-04,
            1.031e-13,
            1.883e-05,
            3.759e-05,
            5.622e-05,
            7.466e-05,
            9.279e-05,
            1.104e-04,
            1.268e-04,
            1.408e-04,
            1.504e-04,
            1.562e-04,
            1.632e-04,
            1.748e-04,
            1.966e-04,
            2.248e-04,
            2.494e-04,
            2.719e-04,
            2.934e-04,
            3.141e-04,
            1.012e-13,
            1.849e-05,
            3.689e-05,
            5.518e-05,
            7.329e-05,
            9.110e-05,
            1.084e-04,
            1.245e-04,
            1.383e-04,
            1.479e-04,
            1.536e-04,
            1.605e-04,
            1.720e-04,
            1.939e-04,
            2.214e-04,
            2.454e-04,
            2.675e-04,
            2.885e-04,
            3.088e-04,
            9.934e-14,
            1.815e-05,
            3.622e-05,
            5.419e-05,
            7.197e-05,
            8.947e-05,
            1.064e-04,
            1.223e-04,
            1.359e-04,
            1.454e-04,
            1.510e-04,
            1.578e-04,
            1.694e-04,
            1.912e-04,
            2.181e-04,
            2.416e-04,
            2.632e-04,
            2.837e-04,
            3.036e-04,
            9.757e-14,
            1.783e-05,
            3.558e-05,
            5.323e-05,
            7.070e-05,
            8.790e-05,
            1.046e-04,
            1.202e-04,
            1.336e-04,
            1.430e-04,
            1.485e-04,
            1.553e-04,
            1.668e-04,
            1.886e-04,
            2.149e-04,
            2.379e-04,
            2.590e-04,
            2.791e-04,
            2.986e-04,
            9.585e-14,
            1.751e-05,
            3.496e-05,
            5.230e-05,
            6.947e-05,
            8.638e-05,
            1.028e-04,
            1.182e-04,
            1.314e-04,
            1.406e-04,
            1.461e-04,
            1.529e-04,
            1.643e-04,
            1.861e-04,
            2.118e-04,
            2.342e-04,
            2.549e-04,
            2.747e-04,
            2.938e-04,
            9.420e-14,
            1.721e-05,
            3.436e-05,
            5.140e-05,
            6.829e-05,
            8.491e-05,
            1.011e-04,
            1.162e-04,
            1.293e-04,
            1.384e-04,
            1.438e-04,
            1.505e-04,
            1.619e-04,
            1.836e-04,
            2.087e-04,
            2.307e-04,
            2.510e-04,
            2.704e-04,
            2.891e-04,
            9.261e-14,
            1.692e-05,
            3.378e-05,
            5.054e-05,
            6.714e-05,
            8.349e-05,
            9.938e-05,
            1.143e-04,
            1.272e-04,
            1.362e-04,
            1.416e-04,
            1.482e-04,
            1.596e-04,
            1.812e-04,
            2.058e-04,
            2.273e-04,
            2.472e-04,
            2.662e-04,
            2.846e-04,
            9.106e-14,
            1.664e-05,
            3.322e-05,
            4.970e-05,
            6.603e-05,
            8.212e-05,
            9.776e-05,
            1.125e-04,
            1.252e-04,
            1.341e-04,
            1.394e-04,
            1.460e-04,
            1.574e-04,
            1.789e-04,
            2.029e-04,
            2.240e-04,
            2.435e-04,
            2.621e-04,
            2.802e-04,
            8.957e-14,
            1.637e-05,
            3.267e-05,
            4.889e-05,
            6.496e-05,
            8.079e-05,
            9.619e-05,
            1.107e-04,
            1.232e-04,
            1.321e-04,
            1.373e-04,
            1.438e-04,
            1.552e-04,
            1.766e-04,
            2.001e-04,
            2.208e-04,
            2.399e-04,
            2.582e-04,
            2.760e-04,
            8.812e-14,
            1.610e-05,
            3.215e-05,
            4.810e-05,
            6.392e-05,
            7.951e-05,
            9.467e-05,
            1.090e-04,
            1.213e-04,
            1.301e-04,
            1.353e-04,
            1.417e-04,
            1.531e-04,
            1.744e-04,
            1.974e-04,
            2.176e-04,
            2.364e-04,
            2.544e-04,
            2.718e-04,
            8.673e-14,
            1.585e-05,
            3.164e-05,
            4.735e-05,
            6.292e-05,
            7.826e-05,
            9.320e-05,
            1.073e-04,
            1.195e-04,
            1.282e-04,
            1.333e-04,
            1.397e-04,
            1.511e-04,
            1.722e-04,
            1.947e-04,
            2.146e-04,
            2.330e-04,
            2.507e-04,
            2.678e-04,
            8.537e-14,
            1.560e-05,
            3.115e-05,
            4.661e-05,
            6.194e-05,
            7.706e-05,
            9.177e-05,
            1.057e-04,
            1.177e-04,
            1.263e-04,
            1.314e-04,
            1.377e-04,
            1.491e-04,
            1.701e-04,
            1.921e-04,
            2.116e-04,
            2.297e-04,
            2.471e-04,
            2.639e-04,
            8.406e-14,
            1.536e-05,
            3.067e-05,
            4.590e-05,
            6.100e-05,
            7.589e-05,
            9.039e-05,
            1.041e-04,
            1.160e-04,
            1.245e-04,
            1.296e-04,
            1.358e-04,
            1.472e-04,
            1.680e-04,
            1.896e-04,
            2.087e-04,
            2.265e-04,
            2.435e-04,
            2.601e-04,
            8.278e-14,
            1.513e-05,
            3.021e-05,
            4.521e-05,
            6.008e-05,
            7.475e-05,
            8.905e-05,
            1.026e-04,
            1.143e-04,
            1.227e-04,
            1.278e-04,
            1.340e-04,
            1.453e-04,
            1.660e-04,
            1.872e-04,
            2.059e-04,
            2.234e-04,
            2.401e-04,
            2.564e-04,
            8.155e-14,
            1.490e-05,
            2.976e-05,
            4.453e-05,
            5.919e-05,
            7.365e-05,
            8.774e-05,
            1.011e-04,
            1.127e-04,
            1.210e-04,
            1.260e-04,
            1.322e-04,
            1.435e-04,
            1.641e-04,
            1.848e-04,
            2.032e-04,
            2.203e-04,
            2.368e-04,
            2.529e-04,
            8.035e-14,
            1.469e-05,
            2.932e-05,
            4.388e-05,
            5.833e-05,
            7.258e-05,
            8.648e-05,
            9.964e-05,
            1.111e-04,
            1.193e-04,
            1.243e-04,
            1.304e-04,
            1.418e-04,
            1.622e-04,
            1.824e-04,
            2.005e-04,
            2.174e-04,
            2.336e-04,
            2.494e-04,
            7.919e-14,
            1.447e-05,
            2.890e-05,
            4.325e-05,
            5.749e-05,
            7.154e-05,
            8.525e-05,
            9.824e-05,
            1.096e-04,
            1.177e-04,
            1.226e-04,
            1.287e-04,
            1.401e-04,
            1.603e-04,
            1.802e-04,
            1.979e-04,
            2.145e-04,
            2.305e-04,
            2.460e-04,
            7.805e-14,
            1.427e-05,
            2.849e-05,
            4.264e-05,
            5.668e-05,
            7.053e-05,
            8.405e-05,
            9.687e-05,
            1.081e-04,
            1.162e-04,
            1.210e-04,
            1.271e-04,
            1.384e-04,
            1.585e-04,
            1.779e-04,
            1.954e-04,
            2.117e-04,
            2.274e-04,
            2.427e-04,
            7.696e-14,
            1.407e-05,
            2.809e-05,
            4.204e-05,
            5.588e-05,
            6.955e-05,
            8.289e-05,
            9.555e-05,
            1.066e-04,
            1.146e-04,
            1.195e-04,
            1.255e-04,
            1.368e-04,
            1.566e-04,
            1.758e-04,
            1.929e-04,
            2.090e-04,
            2.244e-04,
            2.395e-04,
            7.589e-14,
            1.387e-05,
            2.770e-05,
            4.146e-05,
            5.511e-05,
            6.860e-05,
            8.176e-05,
            9.426e-05,
            1.052e-04,
            1.131e-04,
            1.179e-04,
            1.239e-04,
            1.352e-04,
            1.548e-04,
            1.736e-04,
            1.905e-04,
            2.063e-04,
            2.215e-04,
            2.364e-04,
            7.485e-14,
            1.368e-05,
            2.732e-05,
            4.089e-05,
            5.437e-05,
            6.767e-05,
            8.066e-05,
            9.300e-05,
            1.038e-04,
            1.117e-04,
            1.164e-04,
            1.224e-04,
            1.337e-04,
            1.531e-04,
            1.716e-04,
            1.882e-04,
            2.037e-04,
            2.187e-04,
            2.333e-04,
            7.384e-14,
            1.350e-05,
            2.695e-05,
            4.034e-05,
            5.364e-05,
            6.677e-05,
            7.959e-05,
            9.178e-05,
            1.025e-04,
            1.103e-04,
            1.150e-04,
            1.209e-04,
            1.322e-04,
            1.514e-04,
            1.695e-04,
            1.859e-04,
            2.012e-04,
            2.159e-04,
            2.304e-04,
            7.285e-14,
            1.332e-05,
            2.659e-05,
            3.981e-05,
            5.293e-05,
            6.589e-05,
            7.855e-05,
            9.059e-05,
            1.012e-04,
            1.089e-04,
            1.136e-04,
            1.194e-04,
            1.307e-04,
            1.497e-04,
            1.676e-04,
            1.836e-04,
            1.987e-04,
            2.132e-04,
            2.275e-04,
            7.189e-14,
            1.314e-05,
            2.624e-05,
            3.929e-05,
            5.224e-05,
            6.503e-05,
            7.753e-05,
            8.943e-05,
            9.993e-05,
            1.076e-04,
            1.122e-04,
            1.180e-04,
            1.293e-04,
            1.481e-04,
            1.656e-04,
            1.814e-04,
            1.963e-04,
            2.106e-04,
            2.246e-04,
            7.096e-14,
            1.297e-05,
            2.590e-05,
            3.878e-05,
            5.156e-05,
            6.419e-05,
            7.654e-05,
            8.830e-05,
            9.868e-05,
            1.063e-04,
            1.109e-04,
            1.166e-04,
            1.279e-04,
            1.465e-04,
            1.637e-04,
            1.793e-04,
            1.939e-04,
            2.081e-04,
            2.219e-04,
            7.005e-14,
            1.280e-05,
            2.557e-05,
            3.828e-05,
            5.091e-05,
            6.338e-05,
            7.558e-05,
            8.720e-05,
            9.747e-05,
            1.050e-04,
            1.095e-04,
            1.153e-04,
            1.266e-04,
            1.449e-04,
            1.619e-04,
            1.772e-04,
            1.916e-04,
            2.056e-04,
            2.192e-04,
            6.916e-14,
            1.264e-05,
            2.525e-05,
            3.780e-05,
            5.027e-05,
            6.259e-05,
            7.464e-05,
            8.613e-05,
            9.629e-05,
            1.037e-04,
            1.083e-04,
            1.140e-04,
            1.252e-04,
            1.434e-04,
            1.601e-04,
            1.751e-04,
            1.894e-04,
            2.031e-04,
            2.166e-04,
            6.830e-14,
            1.249e-05,
            2.493e-05,
            3.733e-05,
            4.964e-05,
            6.181e-05,
            7.372e-05,
            8.508e-05,
            9.514e-05,
            1.025e-04,
            1.070e-04,
            1.127e-04,
            1.240e-04,
            1.419e-04,
            1.583e-04,
            1.731e-04,
            1.872e-04,
            2.007e-04,
            2.140e-04,
            6.746e-14,
            1.233e-05,
            2.463e-05,
            3.687e-05,
            4.903e-05,
            6.106e-05,
            7.283e-05,
            8.405e-05,
            9.401e-05,
            1.013e-04,
            1.058e-04,
            1.114e-04,
            1.227e-04,
            1.404e-04,
            1.566e-04,
            1.712e-04,
            1.850e-04,
            1.984e-04,
            2.115e-04,
            6.663e-14,
            1.218e-05,
            2.433e-05,
            3.642e-05,
            4.844e-05,
            6.032e-05,
            7.195e-05,
            8.306e-05,
            9.291e-05,
            1.002e-04,
            1.046e-04,
            1.102e-04,
            1.215e-04,
            1.390e-04,
            1.549e-04,
            1.693e-04,
            1.829e-04,
            1.961e-04,
            2.091e-04,
            6.583e-14,
            1.203e-05,
            2.404e-05,
            3.599e-05,
            4.786e-05,
            5.960e-05,
            7.110e-05,
            8.208e-05,
            9.184e-05,
            9.903e-05,
            1.034e-04,
            1.090e-04,
            1.203e-04,
            1.375e-04,
            1.532e-04,
            1.674e-04,
            1.809e-04,
            1.939e-04,
            2.067e-04,
            6.505e-14,
            1.189e-05,
            2.375e-05,
            3.556e-05,
            4.729e-05,
            5.890e-05,
            7.027e-05,
            8.113e-05,
            9.079e-05,
            9.792e-05,
            1.023e-04,
            1.079e-04,
            1.191e-04,
            1.361e-04,
            1.516e-04,
            1.656e-04,
            1.789e-04,
            1.917e-04,
            2.043e-04,
            6.428e-14,
            1.175e-05,
            2.347e-05,
            3.514e-05,
            4.674e-05,
            5.821e-05,
            6.945e-05,
            8.020e-05,
            8.976e-05,
            9.684e-05,
            1.012e-04,
            1.067e-04,
            1.179e-04,
            1.348e-04,
            1.500e-04,
            1.638e-04,
            1.769e-04,
            1.896e-04,
            2.021e-04,
            6.353e-14,
            1.161e-05,
            2.320e-05,
            3.474e-05,
            4.620e-05,
            5.754e-05,
            6.866e-05,
            7.929e-05,
            8.876e-05,
            9.578e-05,
            1.001e-04,
            1.056e-04,
            1.168e-04,
            1.334e-04,
            1.484e-04,
            1.620e-04,
            1.750e-04,
            1.875e-04,
            1.998e-04,
            6.280e-14,
            1.148e-05,
            2.293e-05,
            3.434e-05,
            4.567e-05,
            5.689e-05,
            6.788e-05,
            7.840e-05,
            8.778e-05,
            9.475e-05,
            9.903e-05,
            1.045e-04,
            1.157e-04,
            1.321e-04,
            1.469e-04,
            1.603e-04,
            1.731e-04,
            1.855e-04,
            1.976e-04,
            6.209e-14,
            1.135e-05,
            2.267e-05,
            3.395e-05,
            4.516e-05,
            5.625e-05,
            6.712e-05,
            7.753e-05,
            8.682e-05,
            9.373e-05,
            9.799e-05,
            1.034e-04,
            1.146e-04,
            1.308e-04,
            1.454e-04,
            1.587e-04,
            1.713e-04,
            1.835e-04,
            1.955e-04,
            6.139e-14,
            1.122e-05,
            2.242e-05,
            3.357e-05,
            4.465e-05,
            5.562e-05,
            6.638e-05,
            7.668e-05,
            8.588e-05,
            9.274e-05,
            9.697e-05,
            1.024e-04,
            1.135e-04,
            1.296e-04,
            1.439e-04,
            1.570e-04,
            1.695e-04,
            1.815e-04,
            1.934e-04,
            6.071e-14,
            1.111e-05,
            2.217e-05,
            3.320e-05,
            4.416e-05,
            5.501e-05,
            6.565e-05,
            7.585e-05,
            8.497e-05,
            9.177e-05,
            9.597e-05,
            1.014e-04,
            1.125e-04,
            1.283e-04,
            1.425e-04,
            1.554e-04,
            1.677e-04,
            1.796e-04,
            1.914e-04,
            6.004e-14,
            1.099e-05,
            2.193e-05,
            3.284e-05,
            4.368e-05,
            5.441e-05,
            6.494e-05,
            7.503e-05,
            8.407e-05,
            9.082e-05,
            9.499e-05,
            1.004e-04,
            1.115e-04,
            1.271e-04,
            1.411e-04,
            1.538e-04,
            1.660e-04,
            1.778e-04,
            1.893e-04,
            5.939e-14,
            1.087e-05,
            2.169e-05,
            3.248e-05,
            4.321e-05,
            5.383e-05,
            6.424e-05,
            7.423e-05,
            8.319e-05,
            8.989e-05,
            9.404e-05,
            9.938e-05,
            1.105e-04,
            1.259e-04,
            1.397e-04,
            1.523e-04,
            1.643e-04,
            1.759e-04,
            1.874e-04,
            5.875e-14,
            1.075e-05,
            2.146e-05,
            3.213e-05,
            4.275e-05,
            5.325e-05,
            6.356e-05,
            7.345e-05,
            8.233e-05,
            8.898e-05,
            9.310e-05,
            9.842e-05,
            1.095e-04,
            1.247e-04,
            1.383e-04,
            1.508e-04,
            1.626e-04,
            1.741e-04,
            1.855e-04,
            5.813e-14,
            1.064e-05,
            2.123e-05,
            3.179e-05,
            4.229e-05,
            5.269e-05,
            6.290e-05,
            7.269e-05,
            8.148e-05,
            8.809e-05,
            9.218e-05,
            9.748e-05,
            1.085e-04,
            1.236e-04,
            1.370e-04,
            1.493e-04,
            1.610e-04,
            1.724e-04,
            1.836e-04,
            5.752e-14,
            1.053e-05,
            2.101e-05,
            3.146e-05,
            4.185e-05,
            5.214e-05,
            6.224e-05,
            7.194e-05,
            8.066e-05,
            8.721e-05,
            9.128e-05,
            9.656e-05,
            1.076e-04,
            1.225e-04,
            1.357e-04,
            1.478e-04,
            1.594e-04,
            1.707e-04,
            1.817e-04,
            5.692e-14,
            1.042e-05,
            2.079e-05,
            3.113e-05,
            4.142e-05,
            5.160e-05,
            6.161e-05,
            7.121e-05,
            7.985e-05,
            8.635e-05,
            9.040e-05,
            9.566e-05,
            1.066e-04,
            1.213e-04,
            1.344e-04,
            1.464e-04,
            1.578e-04,
            1.690e-04,
            1.799e-04,
            5.633e-14,
            1.031e-05,
            2.057e-05,
            3.081e-05,
            4.099e-05,
            5.108e-05,
            6.098e-05,
            7.049e-05,
            7.905e-05,
            8.551e-05,
            8.954e-05,
            9.477e-05,
            1.057e-04,
            1.202e-04,
            1.331e-04,
            1.450e-04,
            1.563e-04,
            1.673e-04,
            1.781e-04,
            5.575e-14,
            1.020e-05,
            2.036e-05,
            3.050e-05,
            4.058e-05,
            5.056e-05,
            6.037e-05,
            6.979e-05,
            7.828e-05,
            8.469e-05,
            8.869e-05,
            9.390e-05,
            1.048e-04,
            1.192e-04,
            1.319e-04,
            1.436e-04,
            1.548e-04,
            1.657e-04,
            1.764e-04,
            5.519e-14,
            1.010e-05,
            2.016e-05,
            3.019e-05,
            4.017e-05,
            5.005e-05,
            5.976e-05,
            6.910e-05,
            7.751e-05,
            8.388e-05,
            8.786e-05,
            9.305e-05,
            1.039e-04,
            1.181e-04,
            1.307e-04,
            1.422e-04,
            1.533e-04,
            1.641e-04,
            1.747e-04,
            5.464e-14,
            9.999e-06,
            1.996e-05,
            2.989e-05,
            3.977e-05,
            4.956e-05,
            5.917e-05,
            6.842e-05,
            7.677e-05,
            8.309e-05,
            8.704e-05,
            9.221e-05,
            1.031e-04,
            1.171e-04,
            1.295e-04,
            1.409e-04,
            1.519e-04,
            1.625e-04,
            1.730e-04,
            5.410e-14,
            9.900e-06,
            1.976e-05,
            2.960e-05,
            3.938e-05,
            4.907e-05,
            5.860e-05,
            6.776e-05,
            7.603e-05,
            8.231e-05,
            8.624e-05,
            9.139e-05,
            1.022e-04,
            1.162e-04,
            1.283e-04,
            1.396e-04,
            1.504e-04,
            1.610e-04,
            1.714e-04,
        ]
    ).reshape((100, 19))
    powmux_f = interpolate.interp2d(ys, xs, zz)

    # Get the design spec & parameters from spec file
    try:
        Iload = float(jsonSpec["specifications"]["Iload (mA)"])
    except KeyError as e:
        print(
            "Error: Bad Input Specfile. 'Iload (mA)' value is missing under 'specifications'."
        )
        sys.exit(1)
    except ValueError as e:
        print(
            "Error: Bad Input Specfile. Please use a float value for 'Iload (mA)' under 'specifications'."
        )
        sys.exit(1)
    if Iload > 10.0 or Iload < 0.1:
        print("Error: Only support Iload from 0.1 ~ 10 now")
        sys.exit(1)

    try:
        Frequency = float(jsonSpec["specifications"]["Clock frequency (kHz)"])
    except KeyError as e:
        print(
            "Error: Bad Input Specfile. 'Clock frequency (kHz)' value is missing under 'specifications'."
        )
        sys.exit(1)
    except ValueError as e:
        print(
            "Error: Bad Input Specfile. Please use a float value for 'Clock frequency (kHz)' under 'specifications'."
        )
        sys.exit(1)

    designName = jsonSpec["module_name"]

    SupplyVolt = platformConfig["platforms"][args.platform]["nominal_voltage"]

    print("\n\n<DCDC Spec>")
    print('DCDC Instance Name - "' + designName + '"')
    print('Supply Voltage - "' + str(SupplyVolt) + '"')
    print('Iload(mA) - "' + str(Iload) + '"')
    print('Frequency (kHz) - "' + str(Frequency) + '"')

    # process 2:1 stage switch and cap configuration
    # Technology parameter ######
    if re.search("sky130", args.platform):
        k_sqrt_rc = 6.1e-6
        deltaV = 0.10
        unit_cap_capacitance = 0.27588e-12
        unit_r_resistance = 6750
    #############################

    # Determine the cap and switch size
    dcdc_cap_size = int(
        (Iload * 0.001) / (2 * deltaV * Frequency * 1000) / 2 / unit_cap_capacitance
    )
    if dcdc_cap_size == 0:
        dcdc_cap_size = 1

    dcdc_sw_size = int(
        unit_r_resistance
        / (k_sqrt_rc * SupplyVolt * math.sqrt(Frequency * 1000) / (Iload * 0.001))
    )
    if dcdc_sw_size == 0:
        dcdc_sw_size = 1

    # Determine Offset_y
    # offset_y = 50 * int(dcdc_sw_size / (1<<(dcdc_num_stage-1)))       # Eventually will need this to tune the APR settings
    # if offset_y == 0:
    # offset_y = 50

    # Determine power mux configuration
    num_stages = 6
    powmux_config = []

    for stage in range(0, num_stages):
        Iout_stage = (Iload * 0.001) * pow(2, -(num_stages - (stage + 1)))

        # for voltage, assuming 1/2 vdd for all stages for now
        Vout_stage = 1 / 2 * SupplyVolt

        # calculated load = V/I
        Rout_stage = Vout_stage / Iout_stage

        # single powmux drive
        unit_powmux_current = powmux_f(Vout_stage, Rout_stage)

        # calculate number of parallel muxes
        num_mux = int(math.ceil(Iout_stage / unit_powmux_current))

        powmux_config.append(num_mux)

    powmux_config = ["8'd" + str(cfg) for cfg in powmux_config]

    print("\n\n<DCDC Configuration>")
    print("dcdc_cap_size: " + str(dcdc_cap_size))
    print("dcdc_sw_size: " + str(dcdc_sw_size))
    print("pow_mux_config: " + ",".join(powmux_config) + "\n\n")

    # process 6-stage conv verilog
    with open(srcDir + "/DCDC_SIX_STAGES_CONV.template.v", "r") as file:
        filedata = file.read()
        filedata = re.sub(r"(?<=DCDC_CAP_SIZE = ).+(?=;)", str(dcdc_cap_size), filedata)
        filedata = re.sub(r"(?<=DCDC_SW_SIZE = ).+(?=;)", str(dcdc_sw_size), filedata)
        filedata = re.sub(
            r"(?<=DCDC_PWR_MUX_CONF = ).+(?=;)",
            "{" + ",".join(powmux_config) + "}",
            filedata,
        )

    with open(srcDir + "/DCDC_SIX_STAGES_CONV.v", "w") as file:
        file.write(filedata)

    # process the top level verilog
    r_netlist = open(srcDir + "/dcdcInst.template.v", "r")
    lines = list(r_netlist.readlines())
    w_netlist = open(srcDir + "/dcdcInst.v", "w")

    netmap_top = function.netmap()
    netmap_top.get_net("na", cells["ff_cell"], 1, 1, 1)
    netmap_top.get_net("nb", cells["inv_cell"], 1, 1, 1)
    netmap_top.get_net("nc", cells["clkgate_cell"], 1, 1, 1)

    for line in lines:
        netmap_top.printline(line, w_netlist)

    # process the non-inverting clock verilog
    r_netlist = open(srcDir + "/DCDC_NOV_CLKGEN.template.sv", "r")
    lines = list(r_netlist.readlines())
    w_netlist = open(srcDir + "/DCDC_NOV_CLKGEN.sv", "w")

    netmap_novclkgen = function.netmap()
    netmap_novclkgen.get_net("na", cells["nand2_cell"], 1, 1, 1)
    netmap_novclkgen.get_net("nb", cells["clkinv_cell"], 1, 1, 1)
    netmap_novclkgen.get_net("nc", cells["clkinv_cell"], 1, 1, 1)
    netmap_novclkgen.get_net("ne", cells["clkinv_cell"], 1, 1, 1)
    netmap_novclkgen.get_net("nf", cells["clkinv_cell"], 1, 1, 1)
    netmap_novclkgen.get_net("nd", cells["nor2_cell"], 1, 1, 1)

    for line in lines:
        netmap_novclkgen.printline(line, w_netlist)

    netmap_buffer = function.netmap()
    netmap_buffer.get_net("nb", cells["clkinv_cell"], 1, 1, 1)
    netmap_buffer.get_net("nc", cells["clkinv_cell"], 1, 1, 1)

    r_netlist = open(srcDir + "/DCDC_BUFFER.template.sv", "r")
    lines = list(r_netlist.readlines())
    w_netlist = open(srcDir + "/DCDC_BUFFER.sv", "w")

    for line in lines:
        netmap_buffer.printline(line, w_netlist)

    # process the power mux verilog
    r_netlist = open(srcDir + "/DCDC_POWMUX.template.v", "r")
    lines = list(r_netlist.readlines())
    w_netlist = open(srcDir + "/DCDC_POWMUX.v", "w")

    netmap_powmux = function.netmap()
    # netmap_powmux.get_net('na',cells['inv_cell_w'],1,1,1)
    # netmap_powmux.get_net('nb',cells['inv_cell_w'],1,1,1)

    for line in lines:
        netmap_powmux.printline(line, w_netlist)

    return
